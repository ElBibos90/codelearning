
> codelearning@1.0.0 test
> node --experimental-vm-modules node_modules/jest/bin/jest.js --no-cache tests/services/LessonService.test.js

(node:4340) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL tests/services/LessonService.test.js
  Test Environment
    √ should have correct test environment variables (5 ms)
    √ should mock console.error and console.warn (5 ms)
  LessonService
    Lesson Creation
      √ should create lesson with template (5 ms)
      √ should fail with invalid data (6 ms)
      √ should create lesson with custom content (6 ms)
    Lesson Update and Versioning
      √ should update lesson and create new version (4 ms)
      √ should get lesson versions (7 ms)
      √ should revert to previous version (5 ms)
    Progress Tracking
      × should mark lesson as completed (1 ms)
      × should get progress status (1 ms)
      × should update last accessed timestamp (114 ms)
    Lesson Ordering
      × should reorder lessons (5 ms)
    Content Sanitization
      √ should sanitize HTML content (7 ms)
      √ should preserve markdown content (9 ms)

  ● LessonService › Progress Tracking › should mark lesson as completed

    DatabaseError: Failed to update lesson progress

    [0m [90m 106 |[39m             [36mreturn[39m result[33m;[39m
     [90m 107 |[39m         } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 108 |[39m             [36mthrow[39m [36mnew[39m [33mDatabaseError[39m([32m'Failed to update lesson progress'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 109 |[39m         }
     [90m 110 |[39m     }
     [90m 111 |[39m[0m

      at LessonService.updateProgress (src/services/LessonService.js:108:19)
      at Object.<anonymous> (tests/services/LessonService.test.js:152:50)

  ● LessonService › Progress Tracking › should get progress status

    DatabaseError: Failed to fetch lesson progress

    [0m [90m 115 |[39m             [36mreturn[39m result[33m;[39m
     [90m 116 |[39m         } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 117 |[39m             [36mthrow[39m [36mnew[39m [33mDatabaseError[39m([32m'Failed to fetch lesson progress'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 118 |[39m         }
     [90m 119 |[39m     }
     [90m 120 |[39m[0m

      at LessonService.getProgress (src/services/LessonService.js:117:19)
      at Object.<anonymous> (tests/services/LessonService.test.js:158:50)

  ● LessonService › Progress Tracking › should update last accessed timestamp

    DatabaseError: Failed to update lesson progress

    [0m [90m 106 |[39m             [36mreturn[39m result[33m;[39m
     [90m 107 |[39m         } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 108 |[39m             [36mthrow[39m [36mnew[39m [33mDatabaseError[39m([32m'Failed to update lesson progress'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 109 |[39m         }
     [90m 110 |[39m     }
     [90m 111 |[39m[0m

      at LessonService.updateProgress (src/services/LessonService.js:108:19)
      at Object.<anonymous> (tests/services/LessonService.test.js:167:33)

  ● LessonService › Lesson Ordering › should reorder lessons

    DatabaseError: Failed to create lesson

    [0m [90m 62 |[39m                 [36mthrow[39m error[33m;[39m
     [90m 63 |[39m             }
    [31m[1m>[22m[39m[90m 64 |[39m             [36mthrow[39m [36mnew[39m [33mDatabaseError[39m([32m'Failed to create lesson'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m                   [31m[1m^[22m[39m
     [90m 65 |[39m         }
     [90m 66 |[39m     }
     [90m 67 |[39m[0m

      at LessonService.create (src/services/LessonService.js:64:19)
      at Object.<anonymous> (tests/services/LessonService.test.js:187:29)

Test Suites: 1 failed, 1 total
Tests:       4 failed, 10 passed, 14 total
Snapshots:   0 total
Time:        1.38 s
Ran all test suites matching /tests\\services\\LessonService.test.js/i.
